<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Apply for Services — SuperEdu</title>

<style>
  :root {
    --brand-gold:#D8B04C;
    --brand-green:#2C9C47;
    --bg:#FAF5E9;
    --text:#333;
  }

  body {
    margin:0;
    font-family:Inter,Arial,sans-serif;
    background:var(--bg);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
  }

  .header {
    display:flex;
    justify-content:center;
    padding:22px 0 10px;
  }

  .header img {
    width:110px;
    height:auto;
  }

  .container {
    max-width:820px;
    margin:20px auto;
    padding:16px;
  }

  .card {
    background:#fff;
    padding:22px;
    border-radius:14px;
    box-shadow:0 6px 18px rgba(0,0,0,0.06);
  }

  h1 {
    margin:0 0 10px;
    color:var(--brand-green);
  }

  label {
    display:block;
    margin-top:12px;
    font-size:14px;
    font-weight:600;
  }

  input, textarea {
    width:100%;
    padding:10px;
    border-radius:8px;
    border:1px solid #e8e8e8;
    margin-top:6px;
    font-size:15px;
  }

  .btn {
    background:var(--brand-green);
    color:#fff;
    padding:12px 14px;
    border-radius:10px;
    border:none;
    margin-top:14px;
    cursor:pointer;
    font-weight:700;
    font-size:15px;
  }

  .small {
    font-size:13px;
    color:#7a7a7a;
    margin-top:8px;
  }

  /* ====== PERFECT TWO-COLUMN CHECKBOX GRID ====== */
  .services-checkbox-grid {
    display:grid;
    grid-template-columns:repeat(2,1fr);
    column-gap:24px;
    row-gap:12px;
    margin-top:10px;
  }

  .services-checkbox-grid label {
    display:flex;
    gap:8px;
    align-items:center;
    font-size:14px;
    line-height:1.3;
    cursor:pointer;
  }

  .services-checkbox-grid input[type="checkbox"] {
    width:18px;
    height:18px;
  }
</style>
</head>

<body>


<nav id="topNav" class="nav--solid">
  <div class="nav-inner">
    <div class="brand">
      <a href="/index.html#home" class="brand">
        <img src="/assets/img/superedu-logo.png" alt="SuperEdu" class="logo-img" />
        <span class="brand-text">SuperEdu</span>
      </a>
    </div>

    <div class="menu" id="menu">
      <a href="/index.html#home" data-en="Home" data-zh="首页">Home</a>
      <a href="/index.html#services" data-en="Services" data-zh="服务">Services</a>
      <a href="/index.html#services" data-en="Education Center" data-zh="教育中心">Education Center</a>
      <a href="/index.html#resources" data-en="Resources" data-zh="资源">Resources</a>
      <a href="/index.html#contact" data-en="Contact" data-zh="联系">Contact</a>
    </div>

    <div class="nav-right">
      <button id="langToggle" class="lang-toggle" aria-label="Language toggle">中文</button>
      <button id="hamburger" class="hamburger" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </div>

  <div id="mobileMenu" class="mobile-menu" aria-hidden="true">
    <a href="/index.html#home" data-en="Home" data-zh="首页">Home</a>
    <a href="/index.html#services" data-en="Services" data-zh="服务">Services</a>
    <a href="/index.html#services" data-en="Education Center" data-zh="教育中心">Education Center</a>
    <a href="/index.html#resources" data-en="Resources" data-zh="资源">Resources</a>
    <a href="/index.html#contact" data-en="Contact" data-zh="联系">Contact</a>
  </div>
</nav>



<div class="container">
  <div class="card">

    <h1 data-en="Service Application" data-zh="服务申请">Service Application</h1>
    <p class="small" data-en="Please provide your details and select the services you are interested in."
       data-zh="请输入您的信息并选择您感兴趣的服务。">
       Please provide your details and select the services you are interested in.
    </p>

    <form id="applyForm">

      <label for="firstName" data-en="First name" data-zh="名">First name</label>
      <input id="firstName" name="firstName" required />

      <label for="lastName" data-en="Last name" data-zh="姓">Last name</label>
      <input id="lastName" name="lastName" required />

      <label for="email" data-en="Email" data-zh="邮箱">Email</label>
      <input id="email" name="email" type="email" required />

      <label for="phone" data-en="Phone (optional)" data-zh="电话（可选）">Phone (optional)</label>
      <input id="phone" name="phone" />

      <label for="country" data-en="Country / Region" data-zh="国家 / 地区">Country / Region</label>
      <input id="country" name="country" />

      <label data-en="Select service(s) of interest" data-zh="选择感兴趣的服务">Select service(s) of interest</label>
      <div class="services-checkbox-grid" id="servicesList"></div>

      <label for="notes" data-en="Additional notes (optional)" data-zh="附加说明（可选）">Additional notes (optional)</label>
      <textarea id="notes" name="notes" rows="4"></textarea>

      <div style="display:flex;gap:10px;align-items:center">
        <button type="submit" class="btn" id="submitBtn"
                data-en="Submit Application" data-zh="提交申请">Submit Application</button>
        <div id="formStatus" class="small"></div>
      </div>

    </form>
  </div>
</div>

<script>
/* ===============================
      Service Labels List
================================ */
const serviceItems = [
  {id:'s1', en:'U.S. Education & Comparative Analysis', zh:'美国教育体系与比较分析'},
  {id:'s2', en:'College Application Strategy & Planning', zh:'大学申请策略与规划'},
  {id:'s3', en:'Pre-College Profile Development (AP/Summer Programs)', zh:'大学前背景打造（AP/夏校）'},
  {id:'s4', en:'Financial Aid (FAFSA/CSS) — One-on-One', zh:'助学金（FAFSA/CSS）一对一辅导'},
  {id:'s5', en:'Scholarship Application Support', zh:'奖学金申请辅导'},
  {id:'s6', en:'Family & Long-term Education Planning', zh:'家庭与长期教育规划'},
  {id:'s7', en:'Education Savings & Tax (ESA / 529)', zh:'教育储蓄与税务（ESA / 529）'},
  {id:'s8', en:'College Fund Design & Financial Strategy', zh:'大学基金设计与资金策略'},
  {id:'s9', en:'Family Foundation / 501(c)(3) Setup', zh:'家庭基金会 / 501(c)(3) 设立辅导'},
  {id:'s10', en:'Education + Wealth & Trust Planning', zh:'教育与财富信托规划'}
];

let lang = localStorage.getItem('superedu-lang') || 'en';

/* Render checkboxes */
function renderServices(){
  const wrap = document.getElementById('servicesList');
  wrap.innerHTML = '';
  serviceItems.forEach(s=>{
    const text = lang==='en' ? s.en : s.zh;
    wrap.innerHTML += `
      <label>
        <input type="checkbox" name="services" value="${s.en}">
        <span>${text}</span>
      </label>
    `;
  });
}
renderServices();

/* Language switching */
function setLang(l){
  lang = l;
  localStorage.setItem('superedu-lang',l);

  document.querySelectorAll('[data-en]').forEach(el=>{
    if(el.tagName==='INPUT' || el.tagName==='TEXTAREA') return;
    el.innerText = (l==='en') ? el.dataset.en : el.dataset.zh;
  });

  document.getElementById('submitBtn').innerText =
    (l==='en')?'Submit Application':'提交申请';

  renderServices();
}
setLang(lang);

/* ===============================
      SUBMIT FORM
================================ */
document.getElementById('applyForm').addEventListener('submit', async e =>{
  e.preventDefault();

  // ---- Email format validation ----
  const email = document.getElementById('email').value.trim();
  const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if(!emailPattern.test(email)){
    alert(lang==='zh' ? "请输入有效的邮箱地址" : "Please enter a valid email address");
    return;
  }

  const status = document.getElementById('formStatus');
  status.innerText = lang==='en' ? 'Submitting...' : '提交中...';

  const services = [...document.querySelectorAll('input[name="services"]:checked')]
        .map(i=>i.value);

  const payload = {
    firstName: document.getElementById('firstName').value.trim(),
    lastName: document.getElementById('lastName').value.trim(),
    email,
    phone: document.getElementById('phone').value.trim(),
    country: document.getElementById('country').value.trim(),
    services,
    notes: document.getElementById('notes').value.trim(),
    lang,
    source:'apply_form',
    created_at:new Date().toISOString()
  };

  try{
    const res = await fetch('/api/apply',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(payload)
    });

    const out = await res.json();

    if(res.ok){
      window.location.href = '/thank-you.html';
    } else {
      status.innerText = out.message || (lang==='en'?'Submission failed':'提交失败');
    }
  }catch(err){
    console.error(err);
    status.innerText = lang==='en'?'Submission failed':'提交失败';
  }
});
</script>
</body>
</html>
